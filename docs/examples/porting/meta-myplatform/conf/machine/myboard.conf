# Machine configuration for MyBoard
# Customize this file for your specific platform

#
# Basic Machine Settings
#
MACHINE_FEATURES += "obmc-phosphor-fan-mgmt"
MACHINE_FEATURES += "obmc-phosphor-chassis-mgmt"
MACHINE_FEATURES += "obmc-host-state-mgmt"

#
# Kernel Configuration
#
KERNEL_DEVICETREE = "aspeed/aspeed-bmc-myplatform-myboard.dtb"

#
# U-Boot Configuration
#
PREFERRED_PROVIDER_virtual/bootloader = "u-boot-aspeed"
PREFERRED_PROVIDER_u-boot = "u-boot-aspeed"
PREFERRED_PROVIDER_u-boot-fw-utils = "u-boot-aspeed-fw-utils"

# SPL boot configuration (for dual boot support)
SPL_BINARY = "spl/u-boot-spl.bin"
UBOOT_SUFFIX = "bin"

#
# Flash Configuration
#
FLASH_SIZE = "32768"  # 32MB BMC flash

#
# Console Settings
#
SERIAL_CONSOLES = "115200;ttyS4"

#
# Distro Features - Enable OpenBMC services
#
DISTRO_FEATURES:append = " obmc-phosphor-fan-mgmt"
DISTRO_FEATURES:append = " obmc-phosphor-chassis-mgmt"
DISTRO_FEATURES:append = " obmc-host-state-mgmt"
DISTRO_FEATURES:append = " obmc-ikvm"
DISTRO_FEATURES:append = " obmc-virtual-media"

#
# Image Install - Machine-specific packages
#
IMAGE_INSTALL:append = " \
    entity-manager \
    dbus-sensors \
    phosphor-led-manager \
    phosphor-fan-control \
    phosphor-pid-control \
    phosphor-state-manager \
    phosphor-power \
    myboard-entity-config \
"

#
# IPMI Configuration
#
# Enable IPMI and configure options
VIRTUAL-RUNTIME_obmc-host-ipmi-hw = "phosphor-ipmi-kcs"

#
# LED Configuration
#
OBMC_LED_MANAGER_INSTANCES = "myboard"

#
# Console Configuration
#
OBMC_CONSOLE_HOST_TTY = "ttyVUART0"

#
# Include common ASPEED configuration
#
require conf/machine/include/aspeed.inc
require conf/machine/include/obmc-bsp-common.inc

#
# Network Configuration
#
# Options: rmii, rgmii, ncsi
OBMC_MACHINE_MAC_INTERFACE = "ncsi"
